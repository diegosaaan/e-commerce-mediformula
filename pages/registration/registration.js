"use strict";(self.webpackChunke_commerce=self.webpackChunke_commerce||[]).push([[110],{5542:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(7294),r=a(9655),l=a(8948);const n=[a.p+"assets/images/jpg/auth-background-1.jpg",a.p+"assets/images/jpg/auth-background-2.jpg",a.p+"assets/images/jpg/auth-background-3.jpg",a.p+"assets/images/jpg/auth-background-4.jpg",a.p+"assets/images/jpg/auth-background-5.jpg",a.p+"assets/images/jpg/auth-background-6.jpg"],o=({children:e,name:t,text:a,textLink:o,textButton:i,path:d,title:u,disabled:c,isAddAddress:m,isDataFetching:p,handlePrevRegister:h})=>{const[g,E]=(0,s.useState)("");return(0,s.useEffect)((()=>{const e=Math.floor(Math.random()*n.length);E(n[e])}),[]),s.createElement("section",{className:"auth "+(p?"auth--opacity":""),style:{backgroundImage:`url(${g})`}},s.createElement("div",{className:"auth__container"},s.createElement("div",{className:"auth__container-heading"},s.createElement("h1",{className:"auth__heading"},u),m?s.createElement("button",{className:"auth__button-prev",type:"button",onClick:h}):s.createElement(r.rU,{className:"auth__link auth__link_type_main",to:"/"},"На главную")),s.createElement(l.l0,{className:"auth__form",name:t,autoComplete:"off",noValidate:!0},e,!m&&s.createElement("button",{className:"auth__button",type:"submit",disabled:c},i),s.createElement("p",{className:"auth__text"},a),s.createElement("div",{className:"auth__container-link"},s.createElement(r.rU,{className:"auth__link",to:d},o),s.createElement("div",{className:"auth__arrow"})))))}},1584:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var s=a(8948),r=a(7294),l=a(4309),n=a(2823),o=a(4094),i=a(6642),d=a(8958),u=a(5542),c=a(4250);const m=({addresses:e,name:t,onChange:a,setAddresses:s,setAddressesAnother:l,isAddress:n})=>r.createElement("ul",{className:"auth__list-address"},e.map(((o,i)=>r.createElement("li",{className:"auth__item-address",key:i},r.createElement(c.Z,{className:"auth__input-address",classNameLabel:"auth__label-address",type:"radio",name:t,onChange:a,value:String(i)},r.createElement("span",{className:"auth__span"}),r.createElement("ul",{className:"auth__list-address-value"},r.createElement("li",null,"Страна: ",o.country),r.createElement("li",null,"Город: ",o.city),r.createElement("li",null,"Индекс: ",o.postalCode),r.createElement("li",null,"Улица: ",o.streetName))),r.createElement("div",{className:"auth__item-container"},!n&&1!==e.length&&r.createElement("button",{className:"auth__button-delete",type:"button",onClick:()=>(t=>{const a=e.filter(((e,a)=>a!==t));s&&s(a)})(i)}),!n&&r.createElement("button",{className:"auth__button-copy",type:"button",onClick:()=>(t=>{l&&l((a=>[...a,e[t]]))})(i)}))))));var p=a(5435),h=a(8508),g=a(1970),E=a(8712);const _=()=>{const e=new Date;return e.setFullYear(e.getFullYear()-13),e.setDate(e.getDate()-1),`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`};var y=a(6782);const N=()=>{const{signIn:e}=(0,o.Z)(),t=(0,l.s0)(),a=(0,l.HJ)(),[c,N]=(0,r.useState)(!1),[C,b]=(0,r.useState)(!1),[f,S]=(0,r.useState)(!1),[w,V]=(0,r.useState)(!1),[A,v]=(0,r.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[k,X]=(0,r.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[F,x]=(0,r.useState)([]),[Z,$]=(0,r.useState)([]),M=()=>{N(!0)},P=()=>{N(!1),b(!1),S(!1)},I=()=>{b(!0)},O=()=>{S(!0)};return r.createElement(r.Fragment,null,(w||"loading"===a.state)&&r.createElement(y.Z,{pageClassname:"registration",isDataFetching:w||"loading"===a.state}),r.createElement(s.J9,{initialValues:{firstName:"",lastName:"",date:`${_()}`,email:"",password:"",passwordRepeat:"",shipping:"",billing:""},validationSchema:h.Tu,onSubmit:async a=>{V(!0);const s=Array.from(new Set([...F,...Z].map((e=>JSON.stringify(e))))).map((e=>JSON.parse(e)));let r,l,o,d;""!==a.shipping?(r=JSON.stringify(F[Number(a.shipping)]),o=s.findIndex((e=>JSON.stringify(e)===r))):o=a.shipping,""!==a.billing?(l=JSON.stringify(Z[Number(a.billing)]),d=s.findIndex((e=>JSON.stringify(e)===l))):d=a.billing;const u=F.map((e=>{const t=JSON.stringify(e);return s.findIndex((e=>JSON.stringify(e)===t))})),c=Z.map((e=>{const t=JSON.stringify(e);return s.findIndex((e=>JSON.stringify(e)===t))})),{email:m,firstName:p,lastName:h,password:_,date:y}=a;try{await(0,g.z)(m,p,h,_,y,s,o,d,u,c),await(0,g.x)(m,_);const r=await(0,i.k0)(a.email,a.password);null!==r&&"object"==typeof r&&(n.ZP.info({content:"Регистрация прошла успешно!"}),e((()=>t("/"))),(0,i.F_)(r,"1SortUserToken"),localStorage.removeItem("1SortAnonymousToken"))}catch(e){V(!1);const t=e;if(t.response&&t.response.data){const{statusCode:e,message:a}=t.response.data;(0,E.Z)(e,a)}}}},(({values:e,errors:t,touched:a,handleChange:s,dirty:l})=>r.createElement(u.Z,{name:"form-register",text:"Уже зарегистрированы?",textLink:"Войти",textButton:"Зарегистрироваться",path:"/login",title:"Регистрация",isRegister:!0,isDataFetching:w,disabled:!l||!!(t.firstName||t.lastName||t.date||t.email||t.password||t.passwordRepeat),isAddAddress:c,handlePrevRegister:P},r.createElement("ul",{className:"auth__list auth__list_type_main "+(c?"auth__list_inactive":"auth__list_active")},r.createElement("li",null,r.createElement(d.Z,{type:"text",placeholder:"Имя*",name:"firstName",htmlFor:"firstName",isInputPassword:!1,value:e.firstName,errors:t.firstName,touched:a.firstName,onChange:s})),r.createElement("li",null,r.createElement(d.Z,{type:"text",placeholder:"Фамилия*",name:"lastName",htmlFor:"lastName",isInputPassword:!1,value:e.lastName,errors:t.lastName,touched:a.lastName,onChange:s})),r.createElement("li",null,r.createElement(d.Z,{type:"date",placeholder:"Дата рождения*",name:"date",htmlFor:"date",isInputPassword:!1,onChange:s,value:e.date,errors:t.date,touched:a.date})),r.createElement("li",null,r.createElement(d.Z,{type:"text",placeholder:"Email*",name:"email",htmlFor:"email",isInputPassword:!1,onChange:s,value:e.email,errors:t.email,touched:a.email})),r.createElement("li",null,r.createElement(d.Z,{type:"password",placeholder:"Пароль*",name:"password",htmlFor:"password",isInputPassword:!0,onChange:s,value:e.password,errors:t.password,touched:a.password})),r.createElement("li",null,r.createElement(d.Z,{type:"password",placeholder:"Повторите пароль*",name:"passwordRepeat",htmlFor:"passwordRepeat",isInputPassword:!0,onChange:s,value:e.passwordRepeat,errors:t.passwordRepeat,touched:a.passwordRepeat}))),!c&&r.createElement(r.Fragment,null,r.createElement("button",{className:"auth__button auth__button_type_add",type:"button",onClick:M},"Добавить адреса")),r.createElement("ul",{className:"auth__list "+(c?"auth__list_active":"auth__list_inactive")},r.createElement("li",null,r.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для доставок"),!C&&r.createElement(r.Fragment,null,r.createElement("button",{className:"auth__button-add",type:"button",onClick:I}),r.createElement(m,{name:"shipping",onChange:s,addresses:F,setAddresses:x,setAddressesAnother:$,isAddress:f}),F.length>0&&r.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для доставки по умолчанию кликните на карточку с адресом"))),C&&r.createElement(r.Fragment,null,r.createElement(p.Z,{onChange:s,name:"shipping",addressesState:A,setAddressesState:v}),r.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(A.isPostalCodeError||A.isCityError||A.isStreetError),onClick:()=>(()=>{b(!1);const e=A.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";x((e=>[...e,{country:t,city:A.cityValue,postalCode:A.postalCodeValue,streetName:A.streetValue}]))})()},"Добавить")),r.createElement("li",null,r.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для выставления счетов"),!f&&r.createElement(r.Fragment,null,r.createElement("button",{className:"auth__button-add",type:"button",onClick:O}),r.createElement(m,{name:"billing",onChange:s,addresses:Z,setAddresses:$,setAddressesAnother:x,isAddress:C}),Z.length>0&&r.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для выставления счета по умолчанию кликните на карточку с адресом"))),f&&r.createElement(r.Fragment,null,r.createElement(p.Z,{onChange:s,name:"billing",addressesState:k,setAddressesState:X}),r.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(k.isPostalCodeError||k.isCityError||k.isStreetError),onClick:()=>(()=>{S(!1);const e=k.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";$((e=>[...e,{country:t,city:k.cityValue,postalCode:k.postalCodeValue,streetName:k.streetValue}]))})()},"Добавить")))))))}},5435:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(7294),r=a(8958),l=a(9849);const n=[{postalCode:/^[0-9]{2}-[0-9]{3}$/,errorMessage:"Почтовый индекс должен иметь формат XX-XXX.",engName:"Poland",ruName:"Польша (PL)",code:"PL"},{postalCode:/^[0-9]{3,3}0$/,errorMessage:"Почтовый индекс должен иметь формат XXX0.",engName:"Belgium",ruName:"Бельгия (BE)",code:"BE"},{postalCode:/^\d{5}$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX.",engName:"Germany",ruName:"Германия (DE)",code:"DE"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"Austria",ruName:"Австрия (AT)",code:"AT"},{postalCode:/^\d{5}(?:-\d{4})?$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX, либо XXXXX-XXXX.",engName:"USA",ruName:"США (US)",code:"US"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"France",ruName:"Франция (FR)",code:"FR"}],o=({name:e,addressesState:{countryValue:t,cityValue:a,streetValue:o,postalCodeValue:i},setAddressesState:d})=>{const[u,c]=(0,s.useState)(!1),[m,p]=(0,s.useState)({cityErrorValue:"",streetErrorValue:"",postalCodeErrorValue:"",emptyErrorMessage:"",defaultErrorMessage:"Поле обязательно к заполнению",cityErrorMessage:"Поле должно содержать хотя бы один символ и не содержать специальных символов (!@#$%^&*) или цифр.",streetErrorMessage:"Поле должно содержать хотя бы один символ"}),h=e=>{const t=e.target,a=t.textContent;t&&t.textContent&&("keydown"===e.type&&"Enter"===e.key||"click"===e.type)&&(d((e=>({...e,countryValue:a}))),c(!u))};return(0,s.useEffect)((()=>{(()=>{if(!i)return void p((e=>({...e,postalCodeErrorValue:m.defaultErrorMessage})));const e=n.find((({ruName:e})=>e===t));p((t=>({...t,postalCodeErrorValue:e&&e.postalCode.test(i)?"":`${e?.errorMessage}, где Х - цифра`})))})(),a?/^[^\d!@#$%^&*]*$/.test(a)?p((e=>({...e,cityErrorValue:m.emptyErrorMessage}))):/^[^\d!@#$%^&*]*$/.test(a)||p((e=>({...e,cityErrorValue:m.cityErrorMessage}))):p((e=>({...e,cityErrorValue:m.defaultErrorMessage}))),p(o?e=>({...e,streetErrorValue:m.emptyErrorMessage}):e=>({...e,streetErrorValue:m.defaultErrorMessage})),d((e=>({...e,isPostalCodeError:!!m.postalCodeErrorValue,isCityError:!!m.cityErrorValue,isStreetError:!!m.streetErrorValue})))}),[t,a,o,i,m.postalCodeErrorValue,m.cityErrorValue,m.streetErrorValue]),s.createElement("ul",{className:"auth__list auth__list_active"},s.createElement("li",null,s.createElement(l.Z,{sectionName:"auth",listName:"select",title:t,onClickAccordion:()=>{c(!u)},onKeydownAccordion:e=>{"Enter"===e.key&&c(!u)},isOpen:u},n.filter((({ruName:e})=>t!==e)).map((({ruName:e,engName:t})=>s.createElement("li",{className:"auth__select-list-item",value:t,key:t,tabIndex:u?0:-1,onClick:e=>h(e),onKeyDown:e=>h(e)},e))))),s.createElement("li",null,s.createElement(r.Z,{type:"text",placeholder:"Город*",name:`${e}City`,htmlFor:`${e}City`,onChange:e=>{const t=e.target;d((e=>({...e,cityValue:t.value})))},value:a,errors:m.cityErrorValue})),s.createElement("li",null,s.createElement(r.Z,{type:"text",placeholder:"Почтовый индекс*",name:`${e}Index`,htmlFor:`${e}Index`,onChange:e=>{const t=e.target;d((e=>({...e,postalCodeValue:t.value})))},value:i,errors:m.postalCodeErrorValue})),s.createElement("li",null,s.createElement(r.Z,{type:"text",placeholder:"Улица*",name:`${e}Street`,htmlFor:`${e}Street`,onChange:e=>{const t=e.target;d((e=>({...e,streetValue:t.value})))},value:o,errors:m.streetErrorValue})))}},1970:(e,t,a)=>{a.d(t,{x:()=>i,z:()=>o});var s=a(2861),r=a(9091),l=a(5747),n=a(9037);const o=async(e,t,a,n,o,i,d,u,c,m)=>{let p;return p=""===d&&""===u?{email:e,firstName:t,lastName:a,password:n,dateOfBirth:o,addresses:i,shippingAddresses:c,billingAddresses:m}:""===d?{email:e,firstName:t,lastName:a,password:n,dateOfBirth:o,addresses:i,defaultBillingAddress:u,shippingAddresses:c,billingAddresses:m}:""===u?{email:e,firstName:t,lastName:a,password:n,dateOfBirth:o,addresses:i,defaultShippingAddress:d,shippingAddresses:c,billingAddresses:m}:{email:e,firstName:t,lastName:a,password:n,dateOfBirth:o,addresses:i,defaultShippingAddress:d,defaultBillingAddress:u,shippingAddresses:c,billingAddresses:m},(await s.Z.post(l.Z.URL_CUSTOMERS,p,{headers:await(0,r.o6)()})).data},i=async(e,t)=>{let a;try{a={email:e,password:t,anonymousCart:{id:(await(0,n.CQ)(!1)).id,typeId:"cart"}}}catch(s){const r=s;r.response&&401===r.response.status?a={email:e,password:t}:console.error("Произошла ошибка:",s)}return(await s.Z.post(l.Z.URL_LOGIN,a,{headers:await(0,r.o6)()})).data}}}]);